!function(){function t(){/Mobile/.test(navigator.userAgent)?(this.curPan="log-console",this.eleStyle={},this.inputLog=[],this.xhrDetail={},this.staticSource={},this.init()):console.warn("Lemon must run on a mobile platform")}var e=function(t){var e=document.querySelectorAll(t);return e.length>0?e.length>1?e:e[0]:null},n=function(t,e,n){if(t.length)for(var o=0;o<t.length;o++)t[o].addEventListener(e,n,!1);else t.addEventListener(e,n,!1)},o=function(t,e,n){if(t.length)for(var o=0;o<t.length;o++)t[o].removeEventListener(e,n,!1);else t.removeEventListener(e,n,!1)},i=function(t,e,n){var o=new window._XMLHttpRequest;o.open("get",t,!1),o.onreadystatechange=function(){this.readyState==this.DONE&&(/(^2\d{2})$|304/.test(this.status)?e&&e(this.responseText):n&&n(this))},o.send()},a=function(){return(Math.random()+"").substr(2)},l=function(){return!!window.Blob}();t.prototype={init:function(){this.appendDom(),this.appendStyle(),this.bindEvent()},appendDom:function(){e("body").innerHTML+='<div id="log-container" class="log-container">          <a class="log-switch" href="javascript:;">lemon</a>          <div class="log-pannal pos-r">            <span class="log-detail-close hide">Ã—</span>            <div class="log-detail hide"></div>            <div class="log-pannal-btn-par">              <ul class="log-pannal-btn clearfix">                <li id="log-console" class="fff-b"><a href="javascript:;">Console</a></li>                <li id="log-style"><a href="javascript:;">Style</a></li>                <li id="log-cookie"><a href="javascript:;">Cookie</a></li>                <li id="log-local"><a href="javascript:;">Local</a></li>                <li id="log-session"><a href="javascript:;">Session</a></li>                <li id="log-xhr"><a href="javascript:;">Xhr</a></li>                <li id="log-static"><a href="javascript:;">Static</a></li>              </ul>            </div>            <ul class="log-pannal-log">              <li id="log-console-pan"></li>              <li id="log-style-pan"></li>              <li id="log-cookie-pan" class="hide"></li>              <li id="log-local-pan" class="hide"></li>              <li id="log-session-pan" class="hide"></li>              <li id="log-xhr-pan" class="hide"></li>              <li id="log-static-pan" class="hide"></li>            </ul>            <ul class="log-pannal-bottom">              <li id="log-clear" class="w-20-p" data-type="log-console">                <a href="javascript:;">Clear</a>              </li>              <li class="p-0 w-80" data-type="log-console">                <input id="log-try-input" class="try-input" type="text" placeholder="  Use console.log() to output" value="">              </li>              <li id="log-style-enter" class="hide" data-type="log-style">                <a href="javascript:;">Enter</a>              </li>              <li id="log-style-leave" class="hide" data-type="log-style">                <a href="javascript:;">Leave</a>              </li>              <li id="log-style-detail" class="hide" data-type="log-style">                <a href="javascript:;">detail</a>              </li>              <li id="log-static-css" class="hide" data-type="log-static">                <a href="javascript:;">Css</a>              </li>              <li id="log-static-js" class="hide" data-type="log-static">                <a href="javascript:;">Js</a>              </li>            </ul>          </div>        </div>'},appendStyle:function(){var t=e("#log-container"),n=document.createElement("style");n.setAttribute("scoped",!0),n.textContent="css will be injected",t.insertBefore(n,t.firstElementChild)},bindEvent:function(){this.replaceNativeLog(),this.replaceHttpRequest(),this.selectListener(),this.clearListener(),this.getCookiesListener(),this.getLocalListener(),this.getSessionListener(),this.getStyleListener(),this.getStaticListener(),this.togglePannal(),this.detailClose(),this.tryItOut()},tableBegin:function(t,e,n,o){return'<table class="w-all">                  <col width="'+n+'%">                  <col width="'+o+'%">                  <thead>                    <th>'+t+"</th>                    <th>"+e+"</th>                  </thead>                  <tbody>"},tableEnd:function(){return"</tbody></table>"},detailClose:function(){n(e("#log-container .log-detail-close"),"touchend",function(){this.classList.add("hide"),e("#log-container .log-detail").classList.add("hide"),e("#log-container .log-detail").innerHTML=""})},togglePannal:function(){function t(t){0!=t.changedTouches.length&&(a.style.top=t.changedTouches[0].clientY-r.my+"px",a.style.left=t.changedTouches[0].clientX-r.mx+"px",s=!0)}function i(e){o(document.documentElement||document.body,"touchmove",t),o(document.documentElement||document.body,"touchend",i)}var a=e(".log-container .log-switch"),l=e(".log-container .log-pannal"),s=!1,r={mx:null,my:null};n(e(".log-container .log-switch"),"touchstart",function(e){0!=e.touches.length&&(e.preventDefault(),r.mx=e.touches[0].clientX-this.offsetLeft,r.my=e.touches[0].clientY-this.offsetTop,n(document.documentElement||document.body,"touchmove",t),n(document.documentElement||document.body,"touchend",i))}),n(a,"touchend",function(t){s||l.classList.toggle("hide"),s=!1})},selectListener:function(){var t=this,o=e(".log-pannal-log>li"),i=e(".log-pannal-btn>li"),a=[].reduce.call(i,function(t,e){return t+parseFloat(getComputedStyle(e).width)+11},1);e(".log-pannal-btn").style.width=a+"px",n(i,"touchend",function(){for(var n=0;n<o.length;n++)o[n].classList.add("hide"),i[n].classList.remove("fff-b");t.curPan=this.id,e("#"+t.curPan+"-pan").classList.remove("hide"),this.classList.add("fff-b");for(var a=e(".log-pannal-bottom>li"),l=0;l<a.length;l++)a[l].dataset.type==t.curPan?a[l].classList.remove("hide"):a[l].classList.add("hide")})},clearListener:function(){n(e("#log-clear"),"touchend",function(){e("#log-console-pan").innerHTML=""})},renderLog:function(t){var n="c-black";switch(t.type){case"warn":n="c-orange";break;case"error":n="c-red";break;case"info":n="c-blue"}var o=document.createElement("p");t.log instanceof Error?o.innerHTML=t.log.name+" : "+t.log.message:o.innerHTML="object"==typeof t.log?"<pre><code>"+JSON.stringify(t.log,!1,2)+"</code></pre>":"<pre><code>"+t.log+"</code></pre>",o.className=n,e("#log-console-pan").appendChild(o),e("#log-console-pan").scrollTop=e("#log-console-pan").scrollHeight},replaceHttpRequest:function(){function t(){var n='Uncaught TypeError: Failed to construct "XMLHttpRequest": Please use the "new" operator, this DOM object constructor cannot be called as a function.';if(!(this instanceof t))throw console.error(n),new Error(n);var i=new window._XMLHttpRequest;return i.__lemon_data__={},i.addEventListener("readystatechange",function(){if(this.readyState==this.DONE){var t="c-red";/(^2\d{2})$|304/.test(this.status)?t="c-green":console.error(this.__lemon_data__.method.toUpperCase()+"     "+this.__lemon_data__.requestUrl+"     "+this.status),["responseURL","responseType","timeout","withCredentials"].forEach(function(t){i.__lemon_data__[t]=i[t]||""});try{if(l&&"blob"==i.responseType&&window.FileReader){var n=new FileReader;n.readAsText(i.response),n.onload=function(){i.__lemon_data__.responseText=n.result},n.onerror=function(t){i.__lemon_data__.responseText="Error in FileReader :"+t}}else i.__lemon_data__.responseText=i.responseText}catch(t){i.__lemon_data__.responseText="[ "+i.responseType+" ]"}this.getAllResponseHeaders().split("\n").forEach(function(t){var e=t.split(":");e[0].trim()&&(i.__lemon_data__[e[0]]=e[1])});var s="xhr"+a();o.xhrDetail[s]=this.__lemon_data__;var r='<tr id="'+s+'"><td>'+this.__lemon_data__.requestUrl+'</tb><td class="'+t+'">'+this.status+" "+this.statusText+"</td></tr>";e("#log-xhr-pan tbody").innerHTML+=r}}),i._open=i.open,i.open=function(){for(var t=["method","requestUrl","async","username","password"],e=0;e<t.length;e++){var n=t[e];void 0!==arguments[e]&&(i.__lemon_data__[n]=arguments[e])}return this._open.apply(this,arguments)},i._setRequestHeader=i.setRequestHeader,i.setRequestHeader=function(t,e){return i.__lemon_data__[t]=e,i._setRequestHeader(t,e)},i._send=i.send,i.send=function(t){var e="object"==typeof t?JSON.stringify(t):t;return i.__lemon_data__.body=e||null,i._send(t)},i}var o=this;e("#log-xhr-pan").innerHTML=this.tableBegin("URL","Status",60,40)+this.tableEnd(),n(e("#log-xhr-pan tbody"),"touchend",function(t){var n=t.target;"TD"==n.tagName&&(n=t.target.parentNode);var i=o.xhrDetail[n.id],a=o.tableBegin("prop","value",40,60);for(var l in i)i.hasOwnProperty(l)&&(a+="<tr><td>"+l+"</tb><td>"+i[l]+"</td></tr>");a+=o.tableEnd(),e("#log-container .log-detail").innerHTML=a,e("#log-container .log-detail").classList.remove("hide"),e("#log-container .log-detail-close").classList.remove("hide")}),window._XMLHttpRequest=window.XMLHttpRequest,t.prototype=window._XMLHttpRequest.prototype,window.XMLHttpRequest=t},replaceNativeLog:function(){var t=this;window._console={},["log","error","warn","info","dir"].forEach(function(e){window._console[e]=window.console[e],window.console[e]=function(n){t.renderLog({type:e,log:n});try{return window._console[e](n)}catch(t){}}})},getStyleListener:function(){function t(t){var n=t.target;do{if("log-container"===n.id)return}while(n=n.parentNode);t.target.classList.add("log-action"),t.target!=l&&(l&&l.classList.remove("log-action"),l=t.target);var o=getComputedStyle(t.target);i.eleStyle=o;var a="<tr><td>tagName</tb><td>"+t.target.tagName.toLowerCase()+"</td></tr>";["width","height","paddingTop","paddingBottom","paddingLeft","paddingRight","marginTop","marginBottom","marginLeft","marginRight","display","opacity","zIndex","position","top","bottom","left","right","float","font-size","font-weight","border","lineHeight","overflow"].forEach(function(t){a+="<tr><td>"+t+"</tb><td>"+o[t]+"</td></tr>"}),e("#log-style-pan tbody").innerHTML=a}var i=this,a=!1,l=null,s=!0;e("#log-style-pan").innerHTML=i.tableBegin("prop","value",40,60)+i.tableEnd(),n(e("#log-style-enter"),"touchend",function(){a||(a=!0,s&&(alert("Touch elements to watch computedStyle"),s=!1),n(document.documentElement||document.body,"touchend",t))}),n(e("#log-style-leave"),"touchend",function(){o(document.documentElement||document.body,"touchend",t),l&&l.classList.remove("log-action"),a=!1}),n(e("#log-style-detail"),"touchend",function(){var t=i.tableBegin("prop","value",40,60);for(var n in i.eleStyle)i.eleStyle.hasOwnProperty(n)&&isNaN(1*n)&&"cssText"!==n&&(t+="<tr><td>"+n+"</tb><td>"+i.eleStyle[n]+"</td></tr>");t+=i.tableEnd(),e("#log-container .log-detail").innerHTML=t,e("#log-container .log-detail").classList.remove("hide"),e("#log-container .log-detail-close").classList.remove("hide")})},getCookiesListener:function(){e("#log-cookie-pan").innerHTML=this.tableBegin("key","value",40,60)+this.tableEnd(),n(e("#log-cookie"),"touchend",function(){if(""!==document.cookie){var t="";document.cookie.split("; ").forEach(function(e){var n=e.split("=");t+="<tr><td>"+n[0]+"</tb><td>"+n[1]+"</td></tr>"}),e("#log-cookie-pan tbody").innerHTML=t}})},getSessionListener:function(){e("#log-session-pan").innerHTML=this.tableBegin("key","value",40,60)+this.tableEnd(),n(e("#log-session"),"touchend",function(){if(0!=sessionStorage.length){for(var t="",n=0;n<sessionStorage.length;n++){var o=sessionStorage.key(n);t+="<tr><td>"+o+"</tb><td>"+sessionStorage.getItem(o)+"</td></tr>"}e("#log-session-pan tbody").innerHTML=t}})},getLocalListener:function(){e("#log-local-pan").innerHTML=this.tableBegin("key","value",40,60)+this.tableEnd(),n(e("#log-local"),"touchend",function(){if(0!=localStorage.length){for(var t="",n=0;n<localStorage.length;n++){var o=localStorage.key(n);t+="<tr><td>"+o+"</tb><td>"+localStorage.getItem(o)+"</td></tr>"}e("#log-local-pan tbody").innerHTML=t}})},getStaticListener:function(){var t=this;e("#log-static-pan").innerHTML=t.tableBegin("file","url or inline",60,40)+t.tableEnd(),n(e("#log-static-pan tbody"),"touchend",function(n){var o=n.target;"TD"==o.tagName&&(o=n.target.parentNode);var a=t.staticSource[o.id],l="<pre><code>";"inline"==a.url?l+=a.textContent.replace(/</g,"&lt;"):i(a.url,function(t){l+=t.replace(/</g,"&lt;")},function(t){l+='<p style="color:#CCC;font-size:30px;line-height:100px;text-align:center">'+t.statusText+" "+t.status+"</p>"}),l+="</code></pre>",e("#log-container .log-detail").innerHTML=l,e("#log-container .log-detail").classList.remove("hide"),e("#log-container .log-detail-close").classList.remove("hide")}),n(e("#log-static-css"),"touchend",function(){t.staticSource={};var n="",o=e("link");o=o.length?o:[o];for(c=0;c<o.length;c++){var i=o[c];if("stylesheet"==i.rel&&""!=i.href.trim()){var l=/\/([^\/]+?\.css)/.exec(i.href),s={name:l?l[1]:" ",url:i.href,id:"css"+a()};n+="<tr id="+s.id+" ><td>"+s.name+"</tb><td>"+s.url+"</td></tr>",t.staticSource[s.id]=s}}var r=e("style");r=r.length?r:[r];for(var c=0;c<r.length;c++){var d=r[c];if(""!=d.textContent.trim()){var g={name:"style tag",url:"inline",textContent:d.textContent,id:"css"+a()};n+="<tr id="+g.id+" ><td>"+g.name+"</tb><td>"+g.url+"</td></tr>",t.staticSource[g.id]=g}}e("#log-static-pan tbody").innerHTML=n}),n(e("#log-static-js"),"touchend",function(){t.staticSource={};var n="",o=e("script");o=o.length?o:[o];for(var i=0;i<o.length;i++){var l=o[i];if(""!=l.src.trim()){var s=/\/([^\/]+?\.js)/.exec(l.src),r={name:s?s[1]:" ",url:l.src,id:"js"+a()};n+="<tr id="+r.id+" ><td>"+r.name+"</tb><td>"+r.url+"</td></tr>",t.staticSource[r.id]=r}else if(""!=l.textContent.trim()){var c={name:"script tag",url:"inline",textContent:l.textContent,id:"js"+a()};n+="<tr id="+c.id+" ><td>"+c.name+"</tb><td>"+c.url+"</td></tr>",t.staticSource[c.id]=c}}e("#log-static-pan tbody").innerHTML=n})},tryItOut:function(){var t=this,o=0;n(e("#log-try-input"),"keyup",function(e){var n=e.target.value;if(13==e.keyCode){if(""===n.trim())return;o=0,t.inputLog.push(n);var i=document.createElement("script");return i.async=!1,i.type="text/javascript",i.innerHTML="try{"+n.replace(/(^|[^.])log\(/g," console.log(")+' }catch(e){if(e.message !=="Illegal invocation"){console.log(e.message)}}',document.body.appendChild(i),setTimeout(function(){document.body.removeChild(i)}),void(e.target.value="")}if(38==e.keyCode){if(o>=t.inputLog.length)return;o++}else{if(40!=e.keyCode)return;o--}var a=t.inputLog[t.inputLog.length-o];void 0!==a?e.target.value=a:(o=0,e.target.value="")})}},new t}();